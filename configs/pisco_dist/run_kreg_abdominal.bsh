#!/bin/bash

source ~/anaconda3/etc/profile.d/conda.sh

conda init bash
conda activate nik_mri_clean2
gpu=0
epochs=5000

r=(
1
#2
)
subjects=(
# "1"
# "1cc"
# "2cc"
#  "11_knee"
  "abdominal11_R0"
)
slices=(
#"0"
"10"
#"15"
"20"
#"30"
)

experiments=(
  "configs/pisco_dist/exp_config_kreg_abdominal.yml"
  )


## switch into project directory
echo $PATH
cd ~/workspace/AbdoNIK/
pwd
export PYTHONPATH=$PYTHONPATH:$(pwd)


# Run training for all given experiments
for exp in "${experiments[@]}"; do
  for sub in "${subjects[@]}"; do
    for slice in "${slices[@]}"; do
      for r in "${r[@]}"; do
        python3 train_pisco.py -c "$exp" -sub "$sub" -s "$slice" -r "$r" -g "$gpu" -om 20 -od 1.1 -ep "$epochs" -l 0.01 &
#        wait
        done
#      wait
    done
#    wait
  done
  wait
done